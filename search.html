---
layout: default
title: Search - Avdhesh Kushwah Official
permalink: /search/
---

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <h1 class="text-center mb-4">Site Search</h1>
      
      <input type="text" id="search-input" class="form-control form-control-lg mb-3" 
             placeholder="Search books, gallery, movies..." autocomplete="off">
      
      <div id="search-status" class="mb-3 text-center text-success"></div>
      <div id="search-results"></div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/lunr/lunr.js"></script>

<script>
// AUTO SCAN ALL .html FILES (DEEP FOLDERS TOO)
const searchData = [
  {% assign html_files = site.html_files | where_exp: "file", "file.path != 'search.html'" %}
  {% for file in html_files %}
  {
    "url": "{{ file.url | relative_url }}",
    "title": "{{ file.title | default: file.name | remove: '.html' | replace: '-', ' ' | replace: '_', ' ' | split: '/' | last | capitalize }}",
    "body": {{ file.content | strip_html | truncate: 200 | jsonify }}
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
];

// Debug
console.log('Found HTML files:', {{ site.html_files.size }});
console.log('Search data:', searchData);

let idx;
if (searchData.length > 0) {
  idx = lunr(function () {
    this.ref('url');
    this.field('title');
    this.field('body');
    searchData.forEach(d => this.add(d));
  });
  document.getElementById('search-status').innerHTML = 
    `<span class="text-success">Ready! ${searchData.length} pages indexed.</span>`;
} else {
  document.getElementById('search-status').innerHTML = 
    `<span class="text-danger">No .html files found! Check include paths.</span>`;
}

// Search
document.getElementById('search-input').addEventListener('input', function() {
  const q = this.value.trim();
  const el = document.getElementById('search-results');
  if (!q || !idx) { el.innerHTML = ''; return; }

  const res = idx.search(q + '*');
  if (res.length === 0) {
    el.innerHTML = `<p class="text-muted text-center">No results for "<strong>${q}</strong>"</p>`;
    return;
  }

  el.innerHTML = res.map(r => {
    const d = searchData.find(x => x.url === r.ref);
    return `
      <div class="card mb-3">
        <div class="card-body">
          <h5><a href="${d.url}" class="text-primary">${d.title}</a></h5>
          <p class="text-muted small">${d.url}</p>
          <p class="text-secondary">${d.body}</p>
        </div>
      </div>
    `;
  }).join('');
});
</script>

<style>
  .card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
</style>
